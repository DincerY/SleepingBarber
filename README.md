only main.c code is mine.
